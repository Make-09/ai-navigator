<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Navigator - –ù–∞–≤–∏–≥–∞—Ç–æ—Ä –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, sans-serif; overflow: hidden; }
    #root { width: 100%; height: 100vh; }
    .modal-overlay { 
      position: fixed; 
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0; 
      background: rgba(0,0,0,0.7); 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      z-index: 1000;
      animation: fadeIn 0.2s;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    
    // –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤
    const LOCALES = {
      ru: { 
        code: "ru", 
        name: "–†—É—Å—Å–∫–∏–π", 
        flag: "üá∑üá∫", 
        strings: { 
          title: "AI Navigator", 
          subtitle: "AI-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –∏ –∫–∞—Ä—å–µ—Ä–µ", 
          placeholder: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å...", 
          loading: "AI –¥—É–º–∞–µ—Ç...", 
          error: "–û—à–∏–±–∫–∞", 
          newChat: "–ù–æ–≤—ã–π —á–∞—Ç", 
          deleteChat: "–£–¥–∞–ª–∏—Ç—å", 
          noChats: "–ù–µ—Ç —á–∞—Ç–æ–≤", 
          about: "–û –ø—Ä–æ–µ–∫—Ç–µ", 
          policy: "–ü–æ–ª–∏—Ç–∏–∫–∞", 
          copyright: "–°–æ–∑–¥–∞–Ω–æ —à–∫–æ–ª—å–Ω–∏–∫–∞–º–∏ –∏–∑ –®—ã–º–∫–µ–Ω—Ç–∞ –∏ –£—Ä–∞–ª—å—Å–∫–∞", 
          chatHistory: "–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤", 
          aboutTitle: "–û –ø—Ä–æ–µ–∫—Ç–µ AI Navigator", 
          aboutText: "AI Navigator - —ç—Ç–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞.\n\n–ú—ã –ø–æ–º–æ–≥–∞–µ–º:\n‚Ä¢ –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏—é\n‚Ä¢ –ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –í–£–ó\n‚Ä¢ –°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—å–µ—Ä—É\n‚Ä¢ –ü–æ–ª—É—á–∏—Ç—å —Å–æ–≤–µ—Ç—ã –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é\n\n–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω —à–∫–æ–ª—å–Ω–∏–∫–∞–º–∏ –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤!", 
          policyTitle: "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", 
          policyText: "–í–∞—à–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞ –¥–ª—è –Ω–∞—Å.\n\n‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ\n‚Ä¢ –ú—ã –Ω–µ —Å–æ–±–∏—Ä–∞–µ–º –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ OpenAI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤\n‚Ä¢ –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç" 
        }
      },
      en: { 
        code: "en", 
        name: "English", 
        flag: "üá¨üáß", 
        strings: { 
          title: "AI Navigator", 
          subtitle: "AI mentor for education and career", 
          placeholder: "Write your question...", 
          loading: "AI is thinking...", 
          error: "Error", 
          newChat: "New Chat", 
          deleteChat: "Delete", 
          noChats: "No chats", 
          about: "About", 
          policy: "Privacy", 
          copyright: "Created by students from Shymkent and Uralsk", 
          chatHistory: "Chat History", 
          aboutTitle: "About AI Navigator", 
          aboutText: "AI Navigator is an educational project for students in Kazakhstan.\n\nWe help:\n‚Ä¢ Choose a profession\n‚Ä¢ Find a suitable university\n‚Ä¢ Plan your career\n‚Ä¢ Get education advice\n\nCreated by students for students!", 
          policyTitle: "Privacy Policy", 
          policyText: "Your privacy matters.\n\n‚Ä¢ Chat history is stored only in your browser\n‚Ä¢ We don't collect personal data\n‚Ä¢ Messages are sent only to OpenAI for responses\n‚Ä¢ You can delete history anytime" 
        }
      },
      kk: { 
        code: "kk", 
        name: "“ö–∞–∑–∞“õ—à–∞", 
        flag: "üá∞üáø", 
        strings: { 
          title: "AI Navigator", 
          subtitle: "–ë—ñ–ª—ñ–º –∂”ô–Ω–µ –º–∞–Ω—Å–∞–ø –±–æ–π—ã–Ω—à–∞ AI-–∫–µ“£–µ—Å—à—ñ", 
          placeholder: "–°“±—Ä–∞“ì—ã“£—ã–∑–¥—ã –∂–∞–∑—ã“£—ã–∑...", 
          loading: "AI –æ–π–ª–∞–Ω—É–¥–∞...", 
          error: "“ö–∞—Ç–µ", 
          newChat: "–ñ–∞“£–∞ —á–∞—Ç", 
          deleteChat: "–ñ–æ—é", 
          noChats: "–ß–∞—Ç—Ç–∞—Ä –∂–æ“õ", 
          about: "–ñ–æ–±–∞ —Ç—É—Ä–∞–ª—ã", 
          policy: "–°–∞—è—Å–∞—Ç", 
          copyright: "–®—ã–º–∫–µ–Ω—Ç –∂”ô–Ω–µ –û—Ä–∞–ª –æ“õ—É—à—ã–ª–∞—Ä—ã –∂–∞—Å–∞“ì–∞–Ω", 
          chatHistory: "–ß–∞—Ç —Ç–∞—Ä–∏—Ö—ã", 
          aboutTitle: "AI Navigator —Ç—É—Ä–∞–ª—ã", 
          aboutText: "AI Navigator - “ö–∞–∑–∞“õ—Å—Ç–∞–Ω –æ“õ—É—à—ã–ª–∞—Ä—ã–Ω–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω –±—ñ–ª—ñ–º –±–µ—Ä—É –∂–æ–±–∞—Å—ã.\n\n–ë—ñ–∑ –∫”©–º–µ–∫—Ç–µ—Å–µ–º—ñ–∑:\n‚Ä¢ –ú–∞–º–∞–Ω–¥—ã“õ —Ç–∞“£–¥–∞—É“ì–∞\n‚Ä¢ –ñ–û–û —Ç–∞–±—É“ì–∞\n‚Ä¢ –ú–∞–Ω—Å–∞–ø—Ç—ã –∂–æ—Å–ø–∞—Ä–ª–∞—É“ì–∞\n‚Ä¢ –ë—ñ–ª—ñ–º —Ç—É—Ä–∞–ª—ã –∫–µ“£–µ—Å –∞–ª—É“ì–∞\n\n–û“õ—É—à—ã–ª–∞—Ä –æ“õ—É—à—ã–ª–∞—Ä“ì–∞ –∞—Ä–Ω–∞–ø –∂–∞—Å–∞“ì–∞–Ω!", 
          policyTitle: "“ö“±–ø–∏—è–ª—ã“õ —Å–∞—è—Å–∞—Ç—ã", 
          policyText: "–°—ñ–∑–¥—ñ“£ “õ“±–ø–∏—è–ª—ã–ª—ã“ì—ã“£—ã–∑ –º–∞“£—ã–∑–¥—ã.\n\n‚Ä¢ –ß–∞—Ç —Ç–∞—Ä–∏—Ö—ã —Ç–µ–∫ –±—Ä–∞—É–∑–µ—Ä—ñ“£—ñ–∑–¥–µ —Å–∞“õ—Ç–∞–ª–∞–¥—ã\n‚Ä¢ –ë—ñ–∑ –∂–µ–∫–µ –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ –∂–∏–Ω–∞–º–∞–π–º—ã–∑\n‚Ä¢ –•–∞–±–∞—Ä–ª–∞–º–∞–ª–∞—Ä —Ç–µ–∫ OpenAI-“ì–∞ –∂—ñ–±–µ—Ä—ñ–ª–µ–¥—ñ\n‚Ä¢ –¢–∞—Ä–∏—Ö—Ç—ã –∫–µ–∑ –∫–µ–ª–≥–µ–Ω —É–∞“õ—ã—Ç—Ç–∞ –∂–æ—é“ì–∞ –±–æ–ª–∞–¥—ã" 
        }
      }
    };

    // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function Modal({ isOpen, onClose, title, content, isDark }) {
      if (!isOpen) return null;
      
      const surface = isDark ? '#1e293b' : '#fff';
      const text = isDark ? '#e2e8f0' : '#0f172a';
      
      return (
        <div className="modal-overlay" onClick={onClose}>
          <div 
            onClick={(e) => e.stopPropagation()} 
            style={{ 
              background: surface, 
              borderRadius: 16, 
              padding: '2rem', 
              maxWidth: 600, 
              width: '90%', 
              maxHeight: '80vh', 
              overflow: 'auto',
              boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
            }}
          >
            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '1.5rem' }}>
              <h2 style={{ fontSize: '1.5rem', color: text, fontWeight: 600 }}>{title}</h2>
              <button 
                onClick={onClose} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  fontSize: '1.5rem', 
                  cursor: 'pointer', 
                  color: text,
                  opacity: 0.6,
                  transition: 'opacity 0.2s'
                }}
                onMouseEnter={(e) => e.target.style.opacity = '1'}
                onMouseLeave={(e) => e.target.style.opacity = '0.6'}
              >
                ‚úï
              </button>
            </div>
            <div style={{ whiteSpace: 'pre-wrap', lineHeight: 1.7, color: text }}>
              {content}
            </div>
          </div>
        </div>
      );
    }

    // –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    function App() {
      const [locale, setLocale] = useState('ru');
      const [theme, setTheme] = useState('light');
      const [chats, setChats] = useState([]);
      const [currentChatId, setCurrentChatId] = useState(null);
      const [input, setInput] = useState('');
      const [loading, setLoading] = useState(false);
      const [sidebarOpen, setSidebarOpen] = useState(true);
      const [showAbout, setShowAbout] = useState(false);
      const [showPolicy, setShowPolicy] = useState(false);
      const chatRef = useRef(null);
      
      const t = LOCALES[locale].strings;

      // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
      useEffect(() => {
        const savedTheme = localStorage.getItem('theme') || 'light';
        const savedLocale = localStorage.getItem('locale') || 'ru';
        const savedChats = localStorage.getItem('chats');
        
        setTheme(savedTheme);
        setLocale(savedLocale);
        
        if (savedChats) {
          try {
            const parsedChats = JSON.parse(savedChats);
            setChats(parsedChats);
            if (parsedChats.length > 0) {
              setCurrentChatId(parsedChats[0].id);
            }
          } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–æ–≤:', e);
          }
        }
      }, []);

      // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –ø—Ä–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
      useEffect(() => {
        if (chatRef.current) {
          chatRef.current.scrollTop = chatRef.current.scrollHeight;
        }
      }, [chats, currentChatId]);

      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–∞—Ç–æ–≤
      const saveChats = (updatedChats) => {
        try {
          localStorage.setItem('chats', JSON.stringify(updatedChats));
          setChats(updatedChats);
        } catch (e) {
          console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∞—Ç–æ–≤:', e);
        }
      };

      // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞
      const createNewChat = () => {
        const newChat = {
          id: Date.now(),
          title: `${t.newChat} ${chats.length + 1}`,
          messages: [],
          createdAt: new Date().toISOString()
        };
        saveChats([newChat, ...chats]);
        setCurrentChatId(newChat.id);
        return newChat.id;
      };

      // –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
      const deleteChat = (chatId) => {
        const updatedChats = chats.filter(c => c.id !== chatId);
        saveChats(updatedChats);
        if (currentChatId === chatId) {
          setCurrentChatId(updatedChats.length > 0 ? updatedChats[0].id : null);
        }
      };

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
      const updateCurrentChat = (updater) => {
        saveChats(chats.map(chat => 
          chat.id === currentChatId ? updater(chat) : chat
        ));
      };

      // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
      const sendMessage = async () => {
        if (!input.trim() || loading) return;

        let chatId = currentChatId;
        if (!chatId) {
          chatId = createNewChat();
        }

        const userMsg = input.trim();
        setInput('');

        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const newUserMsg = { 
          role: 'user', 
          content: userMsg, 
          id: Date.now() 
        };
        
        updateCurrentChat(chat => ({
          ...chat,
          messages: [...chat.messages, newUserMsg]
        }));

        setLoading(true);

        try {
          // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é
          const currentChat = chats.find(c => c.id === chatId);
          const history = currentChat ? currentChat.messages : [];

          console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...', { 
            chatId, 
            historyLength: history.length 
          });

          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
          const res = await fetch('/api/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              message: userMsg,
              chatId: chatId,
              history: history
            })
          });

          console.log('üì• –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', res.status);

          if (!res.ok) {
            const errorData = await res.json();
            throw new Error(errorData.error || `HTTP ${res.status}`);
          }

          const data = await res.json();
          console.log('‚úÖ –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç');

          // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç AI
          updateCurrentChat(chat => ({
            ...chat,
            messages: [...chat.messages, {
              role: 'assistant',
              content: data.reply,
              id: Date.now() + 1
            }]
          }));

        } catch (error) {
          console.error('‚ùå –û—à–∏–±–∫–∞:', error);
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –≤ —á–∞—Ç–µ
          updateCurrentChat(chat => ({
            ...chat,
            messages: [...chat.messages, {
              role: 'assistant',
              content: `${t.error}: ${error.message}`,
              id: Date.now() + 1
            }]
          }));
        } finally {
          setLoading(false);
        }
      };

      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
      const toggleTheme = () => {
        const newTheme = theme === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
        localStorage.setItem('theme', newTheme);
      };

      // –°–º–µ–Ω–∞ —è–∑—ã–∫–∞
      const changeLocale = (newLocale) => {
        setLocale(newLocale);
        localStorage.setItem('locale', newLocale);
      };

      // –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
      const isDark = theme === 'dark';
      const bg = isDark ? '#0f172a' : '#f8fafc';
      const surface = isDark ? '#1e293b' : '#fff';
      const text = isDark ? '#e2e8f0' : '#0f172a';
      const textSecondary = isDark ? '#94a3b8' : '#64748b';
      const border = isDark ? '#334155' : '#e2e8f0';
      
      const currentChat = chats.find(c => c.id === currentChatId);

      return (
        <div style={{ 
          background: bg, 
          height: '100vh', 
          color: text, 
          display: 'flex', 
          flexDirection: 'column' 
        }}>
          {/* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */}
          <Modal 
            isOpen={showAbout} 
            onClose={() => setShowAbout(false)} 
            title={t.aboutTitle} 
            content={t.aboutText} 
            isDark={isDark} 
          />
          <Modal 
            isOpen={showPolicy} 
            onClose={() => setShowPolicy(false)} 
            title={t.policyTitle} 
            content={t.policyText} 
            isDark={isDark} 
          />

          {/* –®–∞–ø–∫–∞ */}
          <header style={{ 
            padding: '1rem 1.5rem', 
            borderBottom: `1px solid ${border}`, 
            display: 'flex', 
            justifyContent: 'space-between', 
            alignItems: 'center',
            background: surface 
          }}>
            <div style={{ display: 'flex', gap: '1rem', alignItems: 'center' }}>
              <button 
                onClick={() => setSidebarOpen(!sidebarOpen)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  color: text, 
                  cursor: 'pointer', 
                  fontSize: '1.5rem',
                  padding: '0.5rem'
                }}
              >
                ‚ò∞
              </button>
              <div style={{ display: 'flex', gap: '0.75rem', alignItems: 'center' }}>
                <div style={{ 
                  width: 40, 
                  height: 40, 
                  background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)', 
                  borderRadius: 10, 
                  display: 'flex', 
                  alignItems: 'center', 
                  justifyContent: 'center', 
                  color: 'white', 
                  fontWeight: 'bold',
                  fontSize: '1.2rem'
                }}>
                  AI
                </div>
                <div>
                  <div style={{ fontWeight: 600, fontSize: '1.1rem' }}>{t.title}</div>
                  <div style={{ fontSize: '0.75rem', color: textSecondary }}>{t.subtitle}</div>
                </div>
              </div>
            </div>
            <div style={{ display: 'flex', gap: '0.5rem' }}>
              <select 
                value={locale} 
                onChange={(e) => changeLocale(e.target.value)} 
                style={{ 
                  padding: '0.5rem', 
                  borderRadius: 8, 
                  border: `1px solid ${border}`, 
                  background: surface, 
                  color: text, 
                  cursor: 'pointer',
                  fontSize: '0.9rem'
                }}
              >
                {Object.values(LOCALES).map(loc => (
                  <option key={loc.code} value={loc.code}>
                    {loc.flag} {loc.name}
                  </option>
                ))}
              </select>
              <button 
                onClick={toggleTheme} 
                style={{ 
                  padding: '0.5rem 1rem', 
                  borderRadius: 8, 
                  border: `1px solid ${border}`, 
                  background: surface, 
                  cursor: 'pointer',
                  fontSize: '1.2rem'
                }}
              >
                {isDark ? '‚òÄÔ∏è' : 'üåô'}
              </button>
            </div>
          </header>

          {/* –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å */}
          <div style={{ display: 'flex', flex: 1, overflow: 'hidden' }}>
            {/* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */}
            {sidebarOpen && (
              <aside style={{ 
                width: 280, 
                background: surface, 
                borderRight: `1px solid ${border}`, 
                display: 'flex', 
                flexDirection: 'column', 
                padding: '1rem' 
              }}>
                <button 
                  onClick={createNewChat} 
                  style={{ 
                    padding: '0.75rem', 
                    borderRadius: 8, 
                    background: '#3b82f6', 
                    color: 'white', 
                    border: 'none', 
                    cursor: 'pointer', 
                    fontWeight: 600, 
                    marginBottom: '1rem',
                    fontSize: '0.95rem'
                  }}
                >
                  + {t.newChat}
                </button>
                
                <div style={{ 
                  fontSize: '0.75rem', 
                  fontWeight: 600, 
                  color: textSecondary, 
                  marginBottom: '0.5rem', 
                  textTransform: 'uppercase',
                  letterSpacing: '0.05em'
                }}>
                  {t.chatHistory}
                </div>
                
                <div style={{ flex: 1, overflowY: 'auto' }}>
                  {chats.length === 0 ? (
                    <div style={{ 
                      textAlign: 'center', 
                      padding: '2rem 1rem', 
                      color: textSecondary 
                    }}>
                      {t.noChats}
                    </div>
                  ) : (
                    chats.map(chat => (
                      <div 
                        key={chat.id} 
                        style={{ 
                          display: 'flex', 
                          gap: '0.5rem', 
                          padding: '0.75rem', 
                          marginBottom: '0.5rem', 
                          borderRadius: 8, 
                          background: currentChatId === chat.id 
                            ? (isDark ? '#334155' : '#f1f5f9') 
                            : 'transparent', 
                          cursor: 'pointer',
                          transition: 'background 0.2s'
                        }} 
                        onClick={() => setCurrentChatId(chat.id)}
                      >
                        <div style={{ 
                          flex: 1, 
                          overflow: 'hidden', 
                          textOverflow: 'ellipsis', 
                          whiteSpace: 'nowrap',
                          fontSize: '0.9rem'
                        }}>
                          {chat.messages.length > 0 
                            ? chat.messages[0].content.substring(0, 30) + '...' 
                            : chat.title}
                        </div>
                        <button 
                          onClick={(e) => { 
                            e.stopPropagation(); 
                            deleteChat(chat.id); 
                          }} 
                          style={{ 
                            background: 'none', 
                            border: 'none', 
                            color: '#ef4444', 
                            cursor: 'pointer',
                            opacity: 0.7,
                            transition: 'opacity 0.2s'
                          }}
                          onMouseEnter={(e) => e.target.style.opacity = '1'}
                          onMouseLeave={(e) => e.target.style.opacity = '0.7'}
                        >
                          üóëÔ∏è
                        </button>
                      </div>
                    ))
                  )}
                </div>
              </aside>
            )}

            {/* –û–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ */}
            <main style={{ 
              flex: 1, 
              display: 'flex', 
              flexDirection: 'column', 
              overflow: 'hidden' 
            }}>
              {/* –°–æ–æ–±—â–µ–Ω–∏—è */}
              <div 
                ref={chatRef} 
                style={{ 
                  flex: 1, 
                  overflowY: 'auto', 
                  padding: '2rem', 
                  maxWidth: 900, 
                  margin: '0 auto', 
                  width: '100%' 
                }}
              >
                {(!currentChat || currentChat.messages.length === 0) && (
                  <div style={{ 
                    textAlign: 'center', 
                    padding: '4rem 2rem', 
                    color: textSecondary 
                  }}>
                    <div style={{ fontSize: '4rem', marginBottom: '1rem' }}>üß≠</div>
                    <h2 style={{ color: text, marginBottom: '0.5rem' }}>{t.title}</h2>
                    <p>{t.subtitle}</p>
                  </div>
                )}
                
                {currentChat?.messages.map(msg => (
                  <div 
                    key={msg.id} 
                    style={{ 
                      marginBottom: '1.5rem', 
                      display: 'flex', 
                      justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start' 
                    }}
                  >
                    <div style={{ 
                      maxWidth: '75%', 
                      padding: '1rem 1.25rem', 
                      borderRadius: 16, 
                      background: msg.role === 'user' 
                        ? 'linear-gradient(135deg, #3b82f6, #8b5cf6)' 
                        : (isDark ? '#1e293b' : '#f1f5f9'), 
                      color: msg.role === 'user' ? 'white' : text, 
                      whiteSpace: 'pre-wrap',
                      lineHeight: 1.5
                    }}>
                      {msg.content}
                    </div>
                  </div>
                ))}
                
                {loading && (
                  <div style={{ 
                    padding: '1rem', 
                    color: textSecondary, 
                    fontStyle: 'italic' 
                  }}>
                    {t.loading}
                  </div>
                )}
              </div>

              {/* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */}
              <div style={{ 
                padding: '1.5rem', 
                borderTop: `1px solid ${border}`, 
                background: surface 
              }}>
                <div style={{ 
                  maxWidth: 900, 
                  margin: '0 auto', 
                  display: 'flex', 
                  gap: '0.75rem' 
                }}>
                  <textarea 
                    value={input} 
                    onChange={(e) => setInput(e.target.value)} 
                    onKeyPress={(e) => { 
                      if (e.key === 'Enter' && !e.shiftKey) { 
                        e.preventDefault(); 
                        sendMessage(); 
                      } 
                    }} 
                    placeholder={t.placeholder} 
                    style={{ 
                      flex: 1, 
                      padding: '1rem', 
                      borderRadius: 12, 
                      border: `1px solid ${border}`, 
                      background: isDark ? '#1e293b' : '#fff', 
                      color: text, 
                      resize: 'none',
                      fontSize: '1rem',
                      fontFamily: 'inherit'
                    }} 
                    rows={2} 
                  />
                  <button 
                    onClick={sendMessage} 
                    disabled={loading || !input.trim()} 
                    style={{ 
                      padding: '1rem 2rem', 
                      borderRadius: 12, 
                      background: loading || !input.trim() 
                        ? '#999' 
                        : 'linear-gradient(135deg, #3b82f6, #8b5cf6)', 
                      color: 'white', 
                      border: 'none', 
                      cursor: loading || !input.trim() ? 'not-allowed' : 'pointer', 
                      fontWeight: 600, 
                      fontSize: '1.5rem',
                      transition: 'opacity 0.2s'
                    }}
                  >
                    ‚û§
                  </button>
                </div>
              </div>
            </main>
          </div>

          {/* –§—É—Ç–µ—Ä */}
          <footer style={{ 
            padding: '1rem', 
            textAlign: 'center', 
            borderTop: `1px solid ${border}`, 
            background: surface, 
            fontSize: '0.85rem', 
            color: textSecondary 
          }}>
            <div style={{ marginBottom: '0.5rem' }}>
              <button 
                onClick={() => setShowAbout(true)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  color: '#3b82f6', 
                  cursor: 'pointer', 
                  marginRight: '1.5rem',
                  textDecoration: 'underline'
                }}
              >
                {t.about}
              </button>
              <button 
                onClick={() => setShowPolicy(true)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  color: '#3b82f6', 
                  cursor: 'pointer',
                  textDecoration: 'underline'
                }}
              >
                {t.policy}
              </button>
            </div>
            <div>¬© 2024 AI Navigator ‚Äî {t.copyright}</div>
          </footer>
        </div>
      );
    }

    // –†–µ–Ω–¥–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
